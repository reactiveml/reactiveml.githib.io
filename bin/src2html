#!/bin/sh

if [ $# -ne 6 ]; then
    echo "Usage: $0 rootdir title menu header.html footer.html file.src.html"
    exit 1
fi

ROOTDIR=$1
TITLE=$2
MENU=$3
HEADER=$4
FOOTER=$5
FILE=$6
OCAML_VERSION=`ocamlc -version`
RML_VERSION=`rmlc -version`
DATE=`date "+%Y-%m-%d"`

## Header
cat $HEADER | \
sed -e "s+<#ROOTDIR>+$ROOTDIR+g" | \
sed -e "s+<#TITLE>+$TITLE+g" | \
sed -e "/$MENU/ s+<li>+<li class=\"active\">+g"

## Body
cat $FILE | \
sed -e "s+<#ROOTDIR>+$ROOTDIR+g" | \
sed -e "s+<#OCAML_VERSION>+$OCAML_VERSION+g" | \
sed -e "s+<#RML_VERSION>+$RML_VERSION+g" | \
sed -e "s+<#DATE>+$DATE+g"

## Footer
cat $FOOTER | \
sed -e "s+<#ROOTDIR>+$ROOTDIR+g" | \
sed -e "s+<#OCAML_VERSION>+$OCAML_VERSION+g" | \
sed -e "s+<#RML_VERSION>+$RML_VERSION+g" | \
sed -e "s+<#DATE>+$DATE+g"
